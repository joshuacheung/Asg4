#!/usr/bin/perl
# Joshua Cheung johcheun@ucsc.edu
use strict;
use warnings;

my @inputs;

my $makefile = "test1";
open my $fh, '<', $makefile or die "Cannot open file : $_"; #file handler
use Data::Dumper;


while(my $line = <$fh>){
  chomp $line; #gets rid of whitespace
  push(@inputs, $line);
}

sub parse_dep ($) {
   my ($line) = @_;
    return undef unless $line =~ m/^(\S+)\s*:\s*(.*?)\s*$/;
    my ($target, $dependency) = ($1, $2);
    my @dependencies = split m/\s+/, $dependency;
    return $target, \@dependencies;

}


my %graph;
my %comgraph;
for my $input (@inputs) {
   my ($target, $deps) = parse_dep $input;
   if($input=~ "\t"){
     my $input = s/\t|\n//g;
   }
   if(defined $target){
     $graph{$target} = $deps;
     $comgraph{$target} = $com;
   }
}

print Dumper(\%comgraph);

